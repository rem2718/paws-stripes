<script>
    const displayCards = (experiences, isDel) => {
        const container = document.getElementById("cards-container");
        container.innerHTML = '';
        experiences.forEach(experience => {
            const card = document.createElement("div");
            card.className = "card";
            card.id = `card-${experience._id}`;
            card.innerHTML = `
                    <img src="${experience.image}" alt="Card 1" />
                    <div class="card-text">
                        <h5>Pet name: ${experience.petName}</h5>
                        <h5>
                        User: ${experience.isAnon ? "Anonymous" : experience.userFirstName + " " + experience.userLastName}
                        </h5>
                        <p>${experience.experience}</p>
                    </div>
                    <button onclick="like('${experience._id}')" class="btn like-btn btn-primary">Like</button>
                    <p id="likes-${experience._id}">${experience.likes}</p>
                `;
            if (isDel || "<%=cookies.userType%>" === "admin") {
                card.innerHTML += `
                    <button class="btn like-btn btn-primary" onclick="delExp('${experience._id}')" >delete</button>
                    `;
            }
            container.appendChild(card);
        });
    };

    var pressed = false;
    const like = (expID) => {
        pressed = !pressed;
        const body = { like: pressed ? "like" : "remove like" };
        putRequest(`/api/experiences/${expID}`, body, (response) => {
            console.log(response);
            const likes = document.getElementById(`likes-${response.id}`);
            likes.textContent = response.likes;
        })
    }

    const delExp = (expID) => {
        deleteRequest(`/api/experiences/${expID}`, (response) => {
            console.log(response);
            const card = document.getElementById(`card-${response.id}`);
            card.remove();
        })
    }

    const displayExperiences = (id, isDel) => {
        getRequest(`/api/experiences/${id}`, (response) => {
            displayCards(response, isDel);
        })
    }

    displayExperiences("", false);
</script>